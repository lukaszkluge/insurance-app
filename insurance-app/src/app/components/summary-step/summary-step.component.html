<div class="summary-step">
  <h3>Podsumowanie</h3>
  <p class="step-description">Sprawdź wprowadzone dane przed przesłaniem formularza.</p>

  <div class="summary-content" *ngIf="formData">
    <!-- Personal Data Summary -->
    <mat-card class="summary-card">
      <mat-card-header>
        <mat-icon mat-card-avatar class="section-icon personal-icon">person</mat-icon>
        <mat-card-title>Dane osobowe</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="data-grid">
          <div class="data-item">
            <span class="label">Imię i nazwisko:</span>
            <span class="value">{{ formData.personalData.firstName }} {{ formData.personalData.lastName }}</span>
          </div>
          <div class="data-item">
            <span class="label">PESEL:</span>
            <span class="value">{{ formData.personalData.pesel }}</span>
          </div>
          <div class="data-item">
            <span class="label">E-mail:</span>
            <span class="value">{{ formData.personalData.email }}</span>
          </div>
          <div class="data-item">
            <span class="label">Telefon:</span>
            <span class="value">{{ formData.personalData.phone }}</span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Policy Data Summary -->
    <mat-card class="summary-card">
      <mat-card-header>
        <mat-icon mat-card-avatar class="section-icon policy-icon">description</mat-icon>
        <mat-card-title>Szczegóły polisy</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="data-grid">
          <div class="data-item">
            <span class="label">Data rozpoczęcia:</span>
            <span class="value">{{ formatDate(formData.policyData.startDate) }}</span>
          </div>
          <div class="data-item">
            <span class="label">Suma ubezpieczenia:</span>
            <span class="value highlight">{{ formatCurrency(formData.policyData.coverageAmount) }}</span>
          </div>
          <div class="data-item">
            <span class="label">Typ polisy:</span>
            <span class="value">{{ formData.policyData.policyType || 'Nie wybrano' }}</span>
          </div>
          <div class="data-item full-width" *ngIf="hasSelectedBenefits()">
            <span class="label">Dodatkowe świadczenia:</span>
            <div class="benefits-list">
              <div class="benefit-item" *ngFor="let benefit of getSelectedBenefits()">
                <mat-icon class="benefit-check">check_circle</mat-icon>
                <span>{{ benefit }}</span>
              </div>
            </div>
          </div>
          <div class="data-item full-width" *ngIf="!hasSelectedBenefits()">
            <span class="label">Dodatkowe świadczenia:</span>
            <div *ngIf="additionalCoverage && additionalCoverage.length > 0; else noBenefits">
              <ul>
                <li *ngFor="let benefit of additionalCoverage">{{ benefit }}</li>
              </ul>
            </div>
            <ng-template #noBenefits>
              <p>Brak wybranych dodatkowych świadczeń</p>
            </ng-template>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Premium Estimation -->
    <mat-card class="summary-card premium-card">
      <mat-card-header>
        <mat-icon mat-card-avatar class="section-icon premium-icon">payments</mat-icon>
        <mat-card-title>Szacowana składka roczna</mat-card-title>
        <mat-card-subtitle>Orientacyjna wysokość składki ubezpieczeniowej</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <div class="premium-amount">
          {{ formatCurrency(getEstimatedPremium()) }}
        </div>
        <div class="premium-note">
          <mat-icon>info</mat-icon>
          <span>Ostateczna wysokość składki zostanie ustalona po weryfikacji wniosku</span>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-divider></mat-divider>

    <!-- Terms and Conditions -->
    <form [formGroup]="summaryForm" class="terms-form">
      <div class="terms-section">
        <mat-checkbox formControlName="termsAccepted" class="terms-checkbox">
          <span class="terms-text">
            Oświadczam, że zapoznałem się z 
            <a href="#" class="terms-link">regulaminem</a> oraz 
            <a href="#" class="terms-link">polityką prywatności</a> 
            i wyrażam zgodę na przetwarzanie moich danych osobowych.
          </span>
        </mat-checkbox>
        
        <div class="terms-error" *ngIf="summaryForm.get('termsAccepted')?.invalid && summaryForm.get('termsAccepted')?.touched">
          <mat-icon>error</mat-icon>
          <span>Musisz zaakceptować regulamin i politykę prywatności</span>
        </div>
      </div>
    </form>
  </div>

  <div class="form-status" *ngIf="summaryForm.invalid && summaryForm.touched">
    <mat-icon class="warning-icon">warning</mat-icon>
    <span>Zaakceptuj regulamin i politykę prywatności, aby przesłać formularz</span>
  </div>

  <div class="form-status success" *ngIf="summaryForm.valid">
    <mat-icon class="success-icon">check_circle</mat-icon>
    <span>Formularz jest gotowy do przesłania</span>
  </div>
</div>