<div class="policy-data-step">
  <h3>Szczegóły polisy</h3>
  <p class="step-description">Określ parametry swojej polisy ubezpieczeniowej.</p>

  <form [formGroup]="policyDataForm" class="policy-data-form">
    <div class="form-row">
      <mat-form-field appearance="outline" class="form-field">
        <mat-label>Data rozpoczęcia polisy</mat-label>
        <input matInput 
               [matDatepicker]="picker" 
               formControlName="startDate"
               [min]="minDate"
               [max]="maxDate"
               placeholder="Wybierz datę">
        <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
        <mat-hint>Polisa może rozpocząć się najwcześniej od jutra</mat-hint>
        <mat-error>{{ getErrorMessage('startDate') }}</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="form-field">
        <mat-label>Suma ubezpieczenia</mat-label>
        <input matInput 
               type="number"
               formControlName="coverageAmount"
               placeholder="0"
               min="10000"
               max="1000000">
        <span matTextSuffix>PLN</span>
        <mat-hint>Minimalna suma: 10 000 PLN, maksymalna: 1 000 000 PLN</mat-hint>
        <mat-error>{{ getErrorMessage('coverageAmount') }}</mat-error>
      </mat-form-field>
    </div>

    <div class="additional-benefits-section">
      <h4>Dodatkowe świadczenia</h4>
      <p class="section-description">Wybierz dodatkowe opcje ubezpieczenia (opcjonalne):</p>
      
      <div class="benefits-grid">
        <mat-card class="benefit-card" *ngFor="let benefit of additionalBenefits">
          <mat-card-content>
            <div class="benefit-header">
              <mat-icon class="benefit-icon">{{ benefit.icon }}</mat-icon>
              <div class="benefit-info">
                <h5>{{ benefit.label }}</h5>
                <p>{{ benefit.description }}</p>
              </div>
              <mat-checkbox 
                [checked]="isCoverageSelected(benefit.key)"
                (change)="toggleCoverage(benefit.key, $event.checked)"
                class="benefit-checkbox">
              </mat-checkbox>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
    </div>
  </form>

  <div class="form-status" *ngIf="policyDataForm.invalid && policyDataForm.touched">
    <mat-icon class="warning-icon">warning</mat-icon>
    <span>Uzupełnij wszystkie wymagane pola, aby przejść dalej</span>
  </div>

  <div class="form-status success" *ngIf="policyDataForm.valid">
    <mat-icon class="success-icon">check_circle</mat-icon>
    <span>Parametry polisy zostały ustawione poprawnie</span>
  </div>

  <div class="policy-summary" *ngIf="policyDataForm.valid">
    <h4>Podsumowanie wybranej polisy:</h4>
    <div class="summary-item">
      <strong>Data rozpoczęcia:</strong> 
      {{ policyDataForm.get('startDate')?.value | date:'dd.MM.yyyy' }}
    </div>
    <div class="summary-item">
      <strong>Suma ubezpieczenia:</strong> 
      {{ formatCurrency(policyDataForm.get('coverageAmount')?.value || 0) }}
    </div>
    <div class="summary-item" *ngIf="getSelectedCoverage().length > 0">
      <strong>Dodatkowe świadczenia:</strong>
      <ul class="benefits-list">
        <li *ngFor="let benefit of getSelectedCoverageLabels()">{{ benefit }}</li>
      </ul>
    </div>
    <div class="summary-item" *ngIf="getSelectedCoverage().length === 0">
      <strong>Dodatkowe świadczenia:</strong>
      <span class="value muted">Brak wybranych dodatkowych świadczeń</span>
    </div>
  </div>
</div>